import{r as u,j as e}from"./react-D2Uz9C4f.js";import{c as Bt}from"./react-dom-JE4wjbQD.js";import{u as Tt,L as D,N as T,B as Rt}from"./react-router-dom-d9ToOv3q.js";import{C as xe,c as H}from"./react-hook-form-Dv-Bc-qe.js";import{i as Z}from"./@hookform-DEq2QgbD.js";import{o as Y,a as kt,u as Nt,p as v,m as de,b as ue,c as C,l as Pt,n as pe,d as Et,e as Dt,f as Le,h as j,i as Mt,r as Lt,j as Ot,k as qt,q as Ft,t as Wt}from"./valibot-CrV1I3_1.js";import{P as a}from"./prop-types-C3fnT2fs.js";import{r as Yt,P as Ht,B as I,t as k,a as M,v as Oe,w as qe,x as Fe,y as We,z as Ye,D as He,E as Vt,G as Qt,H as Ve,J as Gt,I as zt,K as Kt,N as $t,O as me,Q as Zt,U as Be,b as Xt,V as Jt,W as _t,X as es,Y as je,Z as P,_ as G,L,$ as ts,a0 as Te,a1 as E,a2 as ne,a3 as Qe,a4 as O,a5 as q,a6 as F,a7 as Ge,a8 as ze,a9 as Ke,aa as ss,ab as os,ac as rs,ad as ns}from"./@mui-KZRTaAo8.js";import{S as as,C as is}from"./react-select-CBApuTP8.js";import{r as ls,O as $}from"./react-hook-form-mui-YeT5x-M6.js";import{a as A}from"./axios-B4uVmeYG.js";import{c as ae,e as $e,b as cs,f as ds,g as N,h as Re}from"./react-router-C_lQfriH.js";import{s as us}from"./mui-file-input-D_QNVRNE.js";import"./@babel-5lteqVtP.js";import"./scheduler-CzFDRTuY.js";import"./@remix-run-CyxMdkWl.js";import"./clsx-B-dksMZM.js";import"./react-is-DcfIKM1A.js";import"./@popperjs-BQBsAJpH.js";import"./@emotion-In3CLkcT.js";import"./hoist-non-react-statics-DQogQWOa.js";import"./stylis-FDnFs_-n.js";import"./react-transition-group-BtfamiIt.js";import"./@floating-ui-C9hIgVAW.js";import"./use-isomorphic-layout-effect-DQoSZGJU.js";import"./memoize-one-BdPwpGay.js";(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const i of o)if(i.type==="childList")for(const l of i.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&r(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const i={};return o.integrity&&(i.integrity=o.integrity),o.referrerPolicy&&(i.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?i.credentials="include":o.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(o){if(o.ep)return;o.ep=!0;const i=n(o);fetch(o.href,i)}})();const ps=(t,s)=>{switch(s.type){case"SHOW":return s.payload;case"HIDE":return{message:null,type:"success"};default:return t}},ve=u.createContext(),ms=t=>{const[s,n]=u.useReducer(ps,{message:null,type:"success"});return e.jsx(ve.Provider,{value:[s,n],children:t.children})},hs=()=>u.useContext(ve)[0],te=()=>u.useContext(ve)[1],gs=(t,s)=>{switch(s.type){case"LOGIN":return s.payload;case"LOGOUT":return null;default:return t}},we=u.createContext(),xs=t=>{const[s,n]=u.useReducer(gs,null);return e.jsx(we.Provider,{value:[s,n],children:t.children})},X=()=>u.useContext(we)[0],Ze=()=>u.useContext(we)[1],bs={button:{color:"white"},ul:{"& .MuiPaginationItem-root":{color:"white","&.Mui-selected":{background:"#609b76"},"&:hover":{backgroundColor:"rgba(96, 155, 118, 0.5)"}}}},Xe=({pages:t,page:s,setPage:n,pageChange:r})=>{const o=async(i,l)=>{n(l),r(i,l)};return t===-1?"":e.jsx(Yt,{spacing:2,children:e.jsx(Ht,{count:t>10?10:t,page:s,onChange:o,sx:bs})})};Xe.propTypes={pages:a.number.isRequired,page:a.number.isRequired,setPage:a.func.isRequired,pageChange:a.func.isRequired};const ke=[{value:28,label:"Action"},{value:12,label:"Adventure"},{value:16,label:"Animation"},{value:35,label:"Comedy"},{value:80,label:"Crime"},{value:99,label:"Documentary"},{value:18,label:"Drama"},{value:10751,label:"Family"},{value:14,label:"Fantasy"},{value:36,label:"History"},{value:27,label:"Horror"},{value:10402,label:"Music"},{value:9648,label:"Mystery"},{value:10749,label:"Romance"},{value:878,label:"Science Fiction"},{value:10770,label:"TV Movie"},{value:53,label:"Thriller"},{value:10752,label:"War"},{value:37,label:"Western"}],ie=({isSubmitting:t,label:s,submittingText:n,normalText:r})=>e.jsx(I,{type:"submit",disabled:t,"aria-label":s,variant:"contained",size:"small",sx:{backgroundColor:"#609b76","&:hover":{backgroundColor:"#00532f"},marginBottom:1},children:t?n:r});ie.propTypes={isSubmitting:a.bool.isRequired,label:a.string.isRequired,submittingText:a.string.isRequired,normalText:a.string.isRequired};const be=({name:t,label:s,control:n})=>e.jsx(ls,{name:t,label:s,control:n,sx:{color:"#609b76"},max:10,min:0,marks:!0,valueLabelDisplay:"auto"});be.propTypes={name:a.string.isRequired,label:a.string.isRequired,control:a.object.isRequired};const fs={label:{color:"#0A6847"},input:{color:"#0A6847"},"& label.Mui-focused":{color:"#0A6847"},"& label.Mui-error":{fontWeight:"bold"},"& .MuiInput-underline:after":{borderBottomColor:"yellow"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#397453"},"&:hover fieldset":{borderColor:"#609b76"},"&.Mui-focused fieldset":{borderColor:"#bdac4e"},"&.Mui-error fieldset":{borderWidth:2}}},K=({name:t,label:s,control:n})=>e.jsx($,{name:t,label:s,fullWidth:!0,control:n,margin:"dense",InputProps:{sx:{borderRadius:0}},sx:fs});K.propTypes={name:a.string.isRequired,label:a.string.isRequired,control:a.object.isRequired};const ys={DropdownIndicator:null},Ne={control:(t,{isFocused:s})=>({...t,backgroundColor:"inherit",borderColor:s?"#bdac4e":"#0A6847",borderWidth:s?"2px":"1px",boxShadow:"60px teal",borderRadius:0,padding:"0.6em 0em","&:hover":{borderColor:"#609b76"}}),placeholder:t=>({...t,color:"#0A6847",fontWeight:400}),menuPortal:t=>({...t,zIndex:9999}),option:t=>({...t,color:"#0A6847"})},Je=({control:t,handleKeyDown:s,isSubmitting:n,actor:r,actors:o,setActor:i,setActors:l,handleSubmit:d})=>e.jsx("form",{onSubmit:d,children:e.jsxs(k,{spacing:1,sx:{padding:"1em"},children:[e.jsxs("div",{children:[e.jsx(xe,{name:"genresSelect",control:t,render:({field:c})=>e.jsx(as,{...c,styles:Ne,options:ke,menuPortalTarget:document.body,isMulti:!0,placeholder:"Select genres"})}),e.jsx(K,{name:"director",label:"Director",control:t}),e.jsx(K,{name:"year",label:"Year",control:t}),e.jsxs("div",{children:[e.jsx(M,{sx:{paddingBottom:"0.5em",color:"#0A6847"},children:"Rating range"}),e.jsx(be,{name:"ratingLower",label:"Lower threshold",control:t}),e.jsx(be,{name:"ratingUpper",label:"Upper threshold",control:t})]})]}),e.jsx("div",{"data-testid":"actor-input",children:e.jsx(xe,{name:"actorsSelect",control:t,render:({field:c})=>e.jsx(is,{...c,components:ys,options:ke,inputValue:r,isMulti:!0,isClearable:!0,menuIsOpen:!1,placeholder:"Type in actor and press enter",onChange:p=>l(p),onInputChange:p=>i(p),onKeyDown:s,value:o,styles:Ne})})}),e.jsx("div",{children:e.jsx(K,{name:"country",label:"Country",control:t})}),e.jsx(ie,{isSubmitting:n,label:"Search for movies",submittingText:"Searching...",normalText:"Search"})]})});Je.propTypes={control:a.object.isRequired,handleKeyDown:a.func.isRequired,isSubmitting:a.bool.isRequired,actor:a.string,actors:a.arrayOf(a.string),setActor:a.func.isRequired,setActors:a.func.isRequired,handleSubmit:a.func.isRequired};const Ce="/api/movies",js=async t=>(await A.post(Ce,t)).data,vs=async t=>(await A.get(`${Ce}/${t}`)).data,ws=async t=>(await A.post(`${Ce}/title`,t)).data,Ae={search:js,getSingleMovie:vs,searchByTitle:ws},Cs=(t,s,n)=>{const{genresSelect:r,director:o,year:i,ratingUpper:l,ratingLower:d,country:c}=t,p=s.map(h=>h.value);return{genres:r?r==null?void 0:r.map(h=>`${h.value}`):[],director:o,year:i,ratingUpper:Number(l),ratingLower:Number(d),actors:p,country:c,page:n}},_e=t=>({label:t,value:t}),As=t=>{const s={genresSelect:t.genres?t.genres.split(",").map(r=>({label:r,value:r})):[],director:t.director||"",year:t.year||"",ratingUpper:Number(t.ratingUpper||10),ratingLower:Number(t.ratingLower||0),country:t.country||""},n=t.actors?t.actors.split(",").map(r=>_e(r)):[];return{parsedData:s,parsedActors:n}},Ss=(t,s)=>{const[n,r]=Tt(),[o,i]=u.useState(""),[l,d]=u.useState([]),[c,p]=u.useState(null),[m,g]=u.useState(1),[h,x]=u.useState(-1),[b,y]=u.useState(!1);u.useEffect(()=>{const S=Object.fromEntries([...n]);if(Object.keys(S).length>0){const{parsedData:w,parsedActors:B}=As(S);p(w),d(B),g(Number(S.page||1)),f(w,Number(S.page||1))}},[n]);const f=async(S,w)=>{p(S);const B=Cs(S,l,w);r({...B,genres:B.genres.join(","),actors:B.actors.join(","),page:w});const{movieToFrontObjectArray:It,totalPages:Ut}=await Ae.search(B);x(Ut),t(It),y(!1)};return{handleKeyDown:S=>{if(o)switch(S.key){case"Enter":case"Tab":d(w=>[...w,_e(o)]),i(""),S.preventDefault()}},handleNewSearch:()=>{s(),d([]),g(1),x(-1),t([]),r({})},searchForMovies:f,firstSearchData:c,page:m,totalPages:h,open:b,actor:o,actors:l,setActor:i,setActors:d,setPage:g,setOpen:y}},Is={backgroundColor:"#609b76","&:hover":{backgroundColor:"#00532f"},marginLeft:"1.15em",marginRight:"1.15em"},Us={width:650,borderRadius:"md",p:3,boxShadow:"lg",bgcolor:"#F6E9B2"},Bs={margin:2,backgroundColor:"#F7E382",color:"#00532f","&:hover":{backgroundColor:"#BDAC4E"}},Ts=Y({genresSelect:kt(Et(Y({label:C("Genre label should be a string"),value:pe("Genre value should be a number")}))),year:Nt([v(C(),ue("1874","Movies can not be shot before 1874"),de(`${new Date().getFullYear()}`,"Can not search for movies shot after current year")),Pt("")]),ratingUpper:v(pe("Rating should be a number"),ue(0,"Rating can not be lower than 0"),de(10,"Rating can not be higher than 10")),ratingLower:v(pe("Rating should be a number"),ue(0,"Rating can not be lower than 0"),de(11,"Rating can not be higher than 10")),country:v(C("Country should be a string"),Dt(100,"Country name can not be this long")),director:C("Director should be a string")}),et=({setMovies:t})=>{const{handleSubmit:s,control:n,formState:{isSubmitting:r},reset:o}=H({resolver:Z(Ts),defaultValues:{genresSelect:[],director:"",year:"",ratingLower:0,ratingUpper:10,country:""}}),{handleKeyDown:i,handleNewSearch:l,searchForMovies:d,firstSearchData:c,page:p,totalPages:m,open:g,actor:h,actors:x,setActor:b,setActors:y,setPage:f,setOpen:U}=Ss(t,o);return e.jsxs("div",{className:"searchPage",children:[e.jsx(I,{variant:"contained",onClick:()=>U(!0),sx:Is,children:"Open Search"}),e.jsx(Oe,{"aria-labelledby":"modal-title","aria-describedby":"modal-desc",open:g,onClose:()=>U(!1),sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(qe,{variant:"outlined",sx:Us,children:[e.jsx(Fe,{variant:"plain",sx:{marginLeft:1}}),e.jsx(Je,{control:n,handleKeyDown:i,isSubmitting:r,actor:h,actors:x,setActor:b,setActors:y,handleSubmit:s(Q=>d(Q,1))})]})}),e.jsx(I,{onClick:l,variant:"contained",sx:Bs,children:"clear search"}),e.jsx(Xe,{pages:m,page:p,setPage:f,pageChange:(Q,S)=>d(c,S)})]})};et.propTypes={setMovies:a.func.isRequired};const _="/assets/posterPlaceholder-I1zggZYb.png",Rs=t=>({borderColor:"#BDAC4E","&:hover":{borderColor:"#BDAC4E",backgroundColor:t?"#BDAC4E":"primary"},backgroundColor:t?"#BDAC4E":"primary",borderWidth:2,fontSize:10,paddingLeft:2,paddingRight:2,color:t?"black":"white",marginRight:1.5,boxShadow:"1px 1px 2px rgba(13, 4, 2, 1)"}),W=({unpressedText:t,pressedText:s,onButtonPress:n,onButtonUnpress:r,movieId:o,user:i})=>{const[l,d]=u.useState(()=>JSON.parse(localStorage.getItem(`pressed ${t} ${o} ${i==null?void 0:i.username}`))??!1);u.useEffect(()=>{localStorage.setItem(`pressed ${t} ${o} ${i==null?void 0:i.username}`,JSON.stringify(l))},[o,i==null?void 0:i.username,l,t]);const c=m=>{try{d(!l),n(m)}catch(g){console.log(g)}},p=m=>{try{d(!l),r(m)}catch(g){console.log(g)}};return e.jsx(I,{variant:l?"contained":"outlined",size:"small",color:l?"success":"primary",sx:()=>Rs(l),onClick:l?p:c,children:l?s:t})};W.propTypes={unpressedText:a.string.isRequired,pressedText:a.string.isRequired,onButtonPress:a.func.isRequired,onButtonUnpress:a.func.isRequired,movieId:a.oneOfType([a.number,a.string]),user:a.object};const ks="https://image.tmdb.org/t/p/original",tt=({movie:t,onButtonPress:s,onButtonUnpress:n,user:r})=>{const[o,i]=u.useState(!1),l=(c,p)=>{s(c,p,{id:t.id,title:t.title,poster:t.image})},d=(c,p)=>{n(c,p,{id:t.id})};return e.jsx(We,{sx:{width:250,height:379,borderRadius:5,marginBottom:3,textAlign:"center",backgroundColor:"#549a71"},className:"movieCard","data-testid":"search-movie-card",children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(Ye,{component:D,to:`/movies/${t.id}`,children:e.jsxs("div",{style:{position:"relative"},children:[e.jsx(He,{component:"picture",sx:{objectFit:"contain"},children:e.jsx("img",{src:o&&t.image?`${ks}${t.image}`:_,alt:t.image?`${t.title}`:`${t.title} poster Icon made by Freepik from www.flaticon.com`,height:"375",loading:"lazy",onLoad:()=>i(!0)})}),e.jsx(Vt,{sx:{background:"linear-gradient(to top, rgba(0,0,0,0.4), rgba(0,0,0,0) 200px), linear-gradient(to top, rgba(0,0,0,0.8), rgba(0,0,0,0) 300px)"}}),e.jsx("div",{style:{position:"absolute",bottom:"20%",left:"50%",transform:"translateX(-50%)"},children:e.jsx(M,{gutterBottom:!0,variant:"h5",component:"div",sx:{fontWeight:"bold",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)",color:"#f7e382"},children:t.title})})]})}),r?e.jsx("div",{style:{position:"absolute",bottom:"0%",left:"50%",transform:"translateX(-50%)",maxWidth:250},children:e.jsxs(Qt,{children:[e.jsx(W,{unpressedText:"Watch",pressedText:"Unwatch",movieId:t.id,user:r,onButtonPress:c=>l(c,"later"),onButtonUnpress:c=>d(c,"later")}),e.jsx(W,{unpressedText:"Favorite",pressedText:"Unfavorite",onButtonPress:c=>l(c,"favorite"),onButtonUnpress:c=>d(c,"favorite"),movieId:t.id,user:r}),e.jsx(W,{unpressedText:"Seen",pressedText:"Unsee",onButtonPress:c=>l(c,"watched"),onButtonUnpress:c=>d(c,"watched"),movieId:t.id,user:r})]})}):""]})})};tt.propTypes={movie:a.object.isRequired,onButtonPress:a.func.isRequired,onButtonUnpress:a.func.isRequired,user:a.object};const st=({movies:t,onButtonPress:s,onButtonUnpress:n})=>{const r=X(),o=t;return e.jsx("div",{className:"listContainer",children:e.jsx("div",{className:"cardsContainer",children:o==null?void 0:o.map(i=>e.jsx(tt,{movie:i,onButtonPress:s,onButtonUnpress:n,user:r},i.id?i.id:i.tmdbId))})})};st.propTypes={movies:a.arrayOf(a.object).isRequired,onButtonPress:a.func.isRequired,onButtonUnpress:a.func.isRequired};const ot=({goToSearch:t})=>e.jsx("div",{className:"scroll-top-button",children:e.jsx(Ve,{onClick:t,sx:{opacity:"0.7",marginLeft:"1em",marginBottom:"1em"},children:e.jsx(Gt,{})})});ot.propTypes={goToSearch:a.func};const Pe={backgroundColor:"#00A660","&:hover":{backgroundColor:"#00755F"},fontSize:20,"@media (max-width: 1024px)":{fontSize:15}},rt=({goToSearch:t})=>{const s=ae();return e.jsxs("div",{className:"hero",children:[e.jsx("div",{className:"box2"}),e.jsx("div",{className:"box1",children:e.jsxs("div",{className:"intro",children:[e.jsxs("h2",{children:["Welcome to ",e.jsx("strong",{children:"Kinology"})]}),e.jsx("div",{children:e.jsx("p",{children:"Choosing a movie made easy"})}),e.jsxs("div",{className:"cta-with-buttons",children:[e.jsxs("div",{className:"search-div",children:["Pick actors, directors or genres ",e.jsx("br",{})," then"," ",e.jsx("strong",{children:"explore"}),e.jsx("div",{className:"searchButton",children:e.jsx(I,{className:"CTA-search",variant:"contained",sx:Pe,onClick:t,children:"Search"})})]}),e.jsxs("div",{className:"register-div",children:[e.jsxs("div",{children:["Too many good options to choose from?",e.jsx("br",{})," Create an account to save movies for later!"]}),e.jsx("div",{className:"registerButton",children:e.jsx(I,{className:"CTA-register",variant:"contained",sx:Pe,onClick:()=>s("/signup"),children:"Register"})})]})]})]})})]})};rt.propTypes={goToSearch:a.func};const Ns={marginLeft:"3em",marginRight:"3em",backgroundColor:"rgba(206, 202, 182, 0.5)",label:{color:"white"},input:{color:"white"},"& label.Mui-focused":{color:"white"},"& label.Mui-error":{fontWeight:"bold"},"& .MuiInput-underline:after":{borderBottomColor:"yellow"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#397453"},"&:hover fieldset":{borderColor:"#609b76"},"&.Mui-focused fieldset":{borderColor:"#bdac4e"},"&.Mui-error fieldset":{borderWidth:2}}},nt=({setMovies:t})=>{const{handleSubmit:s,control:n,formState:{isSubmitting:r,isSubmitSuccessful:o},reset:i}=H({defaultValues:{title:""}});u.useEffect(()=>{o&&i({title:""})},[o,i]);const l=async c=>{const p=await Ae.searchByTitle(c);t(p)},d=()=>{i({title:""}),t([])};return e.jsx("form",{onSubmit:s(l),children:e.jsx("div",{className:"title-search-bar",children:e.jsx($,{name:"title",label:"Search by title",fullWidth:!0,control:n,margin:"dense",InputProps:{sx:{borderRadius:0},endAdornment:e.jsxs(zt,{position:"end",children:[e.jsx(I,{sx:{color:"white"},onClick:d,children:e.jsx(Kt,{sx:{opacity:"0.7"}})}),e.jsx(Ve,{size:"small",type:"submit",sx:{opacity:"0.7"},disabled:r,children:e.jsx($t,{})})]})},sx:Ns})})})};nt.propTypes={setMovies:a.func.isRequired};const at=({onButtonPress:t,onButtonUnpress:s})=>{const[n,r]=u.useState([]),o=u.useRef(null),i=()=>{o.current.scrollIntoView({behavior:"smooth",block:"end"})};return e.jsxs(e.Fragment,{children:[e.jsx(rt,{goToSearch:i}),e.jsxs("div",{id:"search-function",ref:o,children:[e.jsx(nt,{setMovies:r}),e.jsx(et,{setMovies:r}),e.jsx(st,{movies:n,onButtonPress:t,onButtonUnpress:s}),n.length>0&&e.jsx(ot,{goToSearch:i})]})]})};at.propTypes={onButtonPress:a.func,onButtonUnpress:a.func};const Ps={textAlign:"center",color:"#f7e382",fontSize:"1rem",backgroundColor:"rgba(155, 0, 10, 0.4)",borderRadius:2.5,paddingBottom:1,marginLeft:2,"&:hover":{backgroundColor:"rgba(155, 0, 10, 0.8)"}},fe=({handleLogout:t})=>e.jsx(I,{onClick:t,sx:Ps,className:"nav-link","data-testid":"logout-button",children:"log out"});fe.propTypes={handleLogout:a.func.isRequired};const Es=240,Ee=()=>{window.localStorage.removeItem("loggedKinologyUser"),window.location.reload()},it=t=>{const s=Ze(),{window:n}=t,r=X(),[o,i]=u.useState(!1),l=()=>{i(m=>!m)},d=()=>{Ee(),s({type:"LOGOUT"})},c=e.jsxs(me,{onClick:l,sx:{textAlign:"center"},children:[e.jsx(D,{to:"/",className:"site-title",children:e.jsx(M,{variant:"h6",sx:{my:2},className:"site-title",children:"Kinology"})}),e.jsx(es,{}),e.jsxs(je,{children:[e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(T,{to:"/about",className:"nav-link",children:e.jsx(L,{primary:"About"})})})}),r?e.jsxs(e.Fragment,{children:[e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(T,{to:"/me",className:"nav-link",children:e.jsx(L,{primary:"Me"})})})}),e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(T,{to:"/users",className:"nav-link",children:e.jsx(L,{primary:"Users"})})})}),e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(fe,{handleLogout:Ee})})})]}):e.jsxs(e.Fragment,{children:[e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(T,{to:"/login",className:"nav-link",children:e.jsx(L,{primary:"Log in"})})})}),e.jsx(P,{disablePadding:!0,children:e.jsx(G,{sx:{textAlign:"center"},children:e.jsx(T,{to:"/signup",className:"nav-link",children:e.jsx(L,{primary:"Sign up"})})})})]})]})]}),p=n!==void 0?()=>n().document.body:void 0;return e.jsxs(me,{sx:{display:"flex"},children:[e.jsx(Zt,{component:"nav",sx:{bgcolor:"#549a71"},position:"fixed",children:e.jsxs(Be,{children:[e.jsx(Xt,{color:"inherit","aria-label":"open drawer",edge:"start",onClick:l,sx:{mr:2,display:{sm:"none"},color:"#bdac4e"},children:e.jsx(Jt,{})}),e.jsx(M,{variant:"h6",component:"div",sx:{flexGrow:1,display:{xs:"none",sm:"block"}},children:e.jsx(D,{to:"/",className:"site-title",children:"Kinology"})}),e.jsxs(me,{sx:{display:{xs:"none",sm:"block"}},children:[e.jsx(T,{to:"/about",className:"nav-link",children:"About"}),r?e.jsxs(e.Fragment,{children:[e.jsx(T,{to:"/me",className:"nav-link",children:"Me"}),e.jsx(T,{to:"/users",className:"nav-link",children:"Users"}),e.jsx(fe,{handleLogout:d})]}):e.jsxs(e.Fragment,{children:[e.jsx(T,{to:"/login",className:"nav-link",children:"Log in"}),e.jsx(T,{to:"/signup",className:"nav-link",children:"Sign up"})]})]})]})}),e.jsx(Be,{}),e.jsx("nav",{children:e.jsx(_t,{container:p,variant:"temporary",PaperProps:{sx:{bgcolor:"#549a71"}},open:o,onClose:l,ModalProps:{keepMounted:!0},sx:{display:{xs:"block",sm:"none"},"& .MuiDrawer-paper":{boxSizing:"border-box",width:Es}},children:c})})]})};it.propTypes={window:a.instanceOf(window.constructor)};const Ds="https://image.tmdb.org/t/p/original",Se=({movie:t})=>{const[s,n]=u.useState(!1);return e.jsx(We,{sx:{width:100,height:150},children:e.jsx(Ye,{component:D,to:`/movies/${t.tmdbId}`,children:e.jsx(He,{component:"picture",sx:{objectFit:"contain"},children:e.jsx("img",{src:s&&t.poster?`${Ds}${t.poster}`:_,alt:`${t.title} poster`,height:"150",loading:"lazy",onLoad:()=>n(!0)})})})})};Se.propTypes={movie:a.object.isRequired};const Ms="/api/contact",Ls=async t=>(await A.post(Ms,t)).data,Os={sendMessage:Ls},qs={label:{color:"#0A6847"},input:{color:"#0A6847"},"& label.Mui-focused":{color:"#0A6847"},"& label.Mui-error":{fontWeight:"bold"},"& .MuiInputBase-input":{color:"#0A6847"},"& .MuiInput-underline:after":{borderBottomColor:"yellow"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#397453"},"&:hover fieldset":{borderColor:"#609b76"},"&.Mui-focused fieldset":{borderColor:"#bdac4e"},"&.Mui-error fieldset":{borderWidth:2}}},Fs=Y({email:v(C(),j(1,"Please enter your email."),Le("The email address is badly formatted")),name:v(C(),j(1,"Please enter your name or nickname."),j(3,"Name or nickname should be 3 or more symbols")),message:v(C(),j(1,"Please enter your message"),j(3,"Message should be 3 or more symbols "))}),lt=({setOpen:t})=>{const s=te(),{handleSubmit:n,reset:r,control:o,formState:{isSubmitting:i,isSubmitSuccessful:l}}=H({resolver:Z(Fs)});u.useEffect(()=>{l&&r({name:"",email:"",message:""})},[l,r]);const d=async c=>{try{await Os.sendMessage(c),t(!1),s({type:"SHOW",payload:{message:"Your message was sent successfully",type:"success"}}),setTimeout(()=>s({type:"HIDE"}),5e3)}catch{s({type:"SHOW",payload:{message:"Something went wrong when sending your message",type:"error"}}),setTimeout(()=>s({type:"HIDE"}),5e3)}};return e.jsx("form",{onSubmit:n(d),className:"contact-form",children:e.jsxs(k,{spacing:1,sx:{paddingBottom:1},children:[e.jsx(K,{name:"name",label:"Name",control:o}),e.jsx(K,{name:"email",label:"Email",control:o}),e.jsx($,{name:"message",label:"Your message",multiline:!0,inputProps:{spellCheck:"false"},InputProps:{sx:{borderRadius:0}},minRows:5,maxRows:1/0,sx:qs,control:o}),e.jsx(ie,{isSubmitting:i,label:"Submit message",submittingText:"Sending message...",normalText:"Send message"})]})})};lt.propTypes={setOpen:a.func.isRequired};const Ws=()=>{const[t,s]=u.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsx(I,{variant:"contained",onClick:()=>s(!0),sx:{backgroundColor:"#609b76","&:hover":{backgroundColor:"#00532f"},marginBottom:1,marginTop:1},children:"Contact Me"}),e.jsx(Oe,{"aria-labelledby":"modal-title","aria-describedby":"modal-desc",open:t,onClose:()=>s(!1),sx:{display:"flex",justifyContent:"center",alignItems:"center"},children:e.jsxs(qe,{variant:"outlined",sx:{width:650,borderRadius:"md",p:5,boxShadow:"lg",bgcolor:"#F6E9B2"},children:[e.jsx(lt,{setOpen:s}),e.jsx(Fe,{variant:"plain"})]})})]})},Ys=[{title:"Scarface",poster:"/iQ5ztdjvteGeboxtmRdXEChJOHh.jpg",tmdbId:"111"},{title:"The Godfather Part II",poster:"/hek3koDUyRQk7FIhPXsa6mT2Zc3.jpg",tmdbId:"240"},{title:"The Godfather",poster:"/3bhkrj58Vtu7enYsRolD1fZdja1.jpg",tmdbId:"238"},{title:"Apocalypse Now",poster:"/8LHWi5GWEWKL2adSlNI6bZ4wpUW.jpg",tmdbId:"28"},{title:"Sonatine",poster:"/mX9E4fEuG17L2e7bZmhBc0XdRbw.jpg",tmdbId:"7500"},{title:"Casino",poster:"/4TS5O1IP42bY2BvgMxL156EENy.jpg",tmdbId:"524"},{title:"GoodFellas",poster:"/aKuFiU82s5ISJpGZp7YkIr3kCUd.jpg",tmdbId:"769"},{title:"Easy Rider",poster:"/mmGEB6ly9OG8SYVfvAoa6QqHNvN.jpg",tmdbId:"624"},{title:"Full Metal Jacket",poster:"/kMKyx1k8hWWscYFnPbnxxN4Eqo4.jpg",tmdbId:"600"}],Hs=()=>e.jsx("div",{children:e.jsxs("div",{className:"aboutContainer",children:[e.jsxs("div",{className:"box",children:[e.jsx("h2",{children:"About author"}),e.jsxs("div",{className:"content",children:[e.jsxs("div",{className:"about-me-info",children:[e.jsx("div",{children:e.jsx("a",{href:"https://github.com/timmchi",target:"_blank","aria-label":"Github profile",children:e.jsx(ts,{sx:{fontSize:"3rem"}})})}),e.jsx("div",{children:e.jsx(Ws,{})})]}),e.jsx("h3",{children:"Kinology author's favorite movies"}),e.jsx("div",{className:"profileMovieContainer about",children:Ys.map(t=>e.jsx("div",{className:"movieSmallCard",children:e.jsx(Se,{movie:t})},t.tmdbId))})]})]}),e.jsxs("div",{className:"box",children:[e.jsx("h2",{children:"Web app uses TMDB api"}),e.jsxs("div",{className:"content",children:[e.jsx("p",{children:"This website uses TMDB (The Movie Database) api to implement its core functionality, and I am highly thankful to them for providing their api for free."}),e.jsx("p",{children:"TMDB api has great documentation and it is fairly easy to use, so I suggest you give it a shot if you have some web app ideas related to movies."}),e.jsxs("p",{children:["Link to TMDB"," ",e.jsx("a",{href:"https://www.themoviedb.org",target:"_blank","aria-label":"TMDB link",children:e.jsx(Te,{sx:{fontSize:"2rem"}})})]})]})]}),e.jsxs("div",{className:"box",children:[e.jsx("h2",{children:"Fullstack open"}),e.jsxs("div",{className:"content",children:[e.jsx("p",{children:"This website is my submission for the final project part of Full Stack Open course, worth 10 credits or 175 hours."}),e.jsxs("p",{children:[" ","I gained most of my React and Node knowledge through that course, so I highly recommend it to anyone who wants to get better at modern web development."]}),e.jsxs("p",{children:["Link to the course"," ",e.jsx("a",{href:"https://fullstackopen.com/en/",target:"_blank","aria-label":"Fullstackopen link",children:e.jsx(Te,{sx:{fontSize:"2rem"}})})]})]})]})]})}),De={bgcolor:"#79C094",input:{color:"white",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},borderRadius:0,padding:1.5,"--Input-placeholderOpacity":1,"--Input-focusedInset":"var(--any, )","--Input-focusedThickness":"2px","--Input-focusedHighlight":"#bdac4e !important","&:focus-within":{borderColor:"#bdac4e"}},Vs={width:{xs:"100%",md:"50vw"},transition:"width var(--Transition-duration)",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",position:"relative",zIndex:1,display:"flex",justifyContent:"flex-end",backdropFilter:"blur(12px)",backgroundColor:"rgba(255 255 255 / 0.2)"},Qs={height:"100%",position:"fixed",right:0,top:0,bottom:0,left:{xs:0,md:"50vw"},transition:"background-image var(--Transition-duration), left var(--Transition-duration) !important",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundImage:"url(https://images.unsplash.com/photo-1589053739346-ed32227546a4?q=80&w=1031&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D)"},Gs={display:"flex",flexDirection:"column",minHeight:"100dvh",width:"100%",px:2},zs={my:"auto",py:2,pb:5,display:"flex",flexDirection:"column",gap:2,width:400,maxWidth:"100%",mx:"auto",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)",borderRadius:"sm","& form":{display:"flex",flexDirection:"column",gap:2},"& .MuiFormLabel-asterisk":{visibility:"hidden"}},Ks=Y({username:v(C("Username must be a string."),j(1,"Please enter your username."),j(3,"Username needs to be at least 3 characters long.")),password:v(C("Your password must be a string."),j(1,"Password is required."),j(6,"Your password must have 6 characters or more."))}),he={color:"#f7e382",fontSize:18},ye=({handleLogin:t})=>{var d,c,p,m;const{register:s,handleSubmit:n,reset:r,formState:{errors:o,isSubmitting:i,isSubmitSuccessful:l}}=H({resolver:Z(Ks)});return u.useEffect(()=>{l&&r({username:"",password:""})},[l,r]),e.jsxs("div",{style:{backgroundColor:"#397453"},children:[e.jsx(E,{sx:Vs,children:e.jsx(E,{sx:Gs,children:e.jsxs(E,{component:"main",sx:zs,children:[e.jsx(k,{gap:4,sx:{mb:2},children:e.jsxs(k,{gap:1,children:[e.jsx(ne,{component:"h1",level:"h3",sx:{color:"#f7e382"},children:"Log in"}),e.jsxs(ne,{level:"body-sm",sx:he,children:["New to Kinology?"," ",e.jsx(D,{to:"/signup",sx:{color:"#E6E9E0"},children:"Create an account"})]})]})}),e.jsx(Qe,{sx:{bgcolor:"#bdac4e"}}),e.jsx(k,{gap:4,sx:{mt:2},children:e.jsxs("form",{onSubmit:n(t),children:[e.jsxs(O,{children:[e.jsx(q,{sx:he,children:"Username"}),e.jsx(F,{...s("username"),placeholder:"Your username","data-testid":"username",sx:De}),(d=o==null?void 0:o.username)!=null&&d.message?e.jsx("p",{style:{color:"red"},children:(c=o.username)==null?void 0:c.message}):null]}),e.jsxs(O,{children:[e.jsx(q,{sx:he,children:"Password"}),e.jsx(F,{type:"password",...s("password"),placeholder:"Your password","data-testid":"password",autoComplete:"on",sx:De}),(p=o==null?void 0:o.password)!=null&&p.message?e.jsx("p",{style:{color:"red"},children:(m=o.password)==null?void 0:m.message}):null]}),e.jsx(Ge,{type:"submit",fullWidth:!0,disabled:i,id:"login-button",sx:{fontSize:18},children:i?"Logging in...":"Log In"})]})})]})})}),e.jsx(E,{sx:Qs})]})};ye.propTypes={handleLogin:a.func.isRequired};const $s="/api/users",Zs=async t=>(await A.post($s,t)).data,Xs={signUp:Zs},Js=t=>{const s=ae(),n=te();return{handleSignUp:async o=>{const{username:i,email:l,password:d,passwordConfirm:c,name:p}=o;try{const m=await Xs.signUp({username:i,email:l,password:d,passwordConfirm:c,name:p});t(m),n({type:"SHOW",payload:{message:"Sign up was successful, please log in",type:"success"}}),setTimeout(()=>n({type:"HIDE"}),5e3),s("/login")}catch{n({type:"SHOW",payload:{message:"Something went wrong when signing up",type:"error"}}),setTimeout(()=>n({type:"HIDE"}),5e3)}}}},J={bgcolor:"#79C094",input:{color:"white",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},borderRadius:0,padding:1.5,"--Input-placeholderOpacity":1,"--Input-focusedInset":"var(--any, )","--Input-focusedThickness":"2px","--Input-focusedHighlight":"#bdac4e !important","&:focus-within":{borderColor:"#bdac4e"}},z={color:"#f7e382",fontSize:18},_s={width:{xs:"100%",md:"50vw"},transition:"width var(--Transition-duration)",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",position:"relative",zIndex:1,display:"flex",justifyContent:"flex-end",backdropFilter:"blur(12px)",backgroundColor:"rgba(255 255 255 / 0.2)"},eo={display:"flex",flexDirection:"column",minHeight:"100dvh",width:"100%",px:2},to={height:"100%",position:"fixed",right:0,top:0,bottom:0,left:{xs:0,md:"50vw"},transition:"background-image var(--Transition-duration), left var(--Transition-duration) !important",transitionDelay:"calc(var(--Transition-duration) + 0.1s)",backgroundSize:"cover",backgroundPosition:"center",backgroundRepeat:"no-repeat",backgroundImage:"url(https://images.unsplash.com/photo-1589053739346-ed32227546a4?q=80&w=1031&auto=format&fit=crop&ixlib=rb-4.0.3&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D)"},so={my:"auto",py:2,pb:5,display:"flex",flexDirection:"column",gap:2,width:400,maxWidth:"100%",mx:"auto",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)",borderRadius:"sm","& form":{display:"flex",flexDirection:"column",gap:2},"& .MuiFormLabel-asterisk":{visibility:"hidden"}},oo=v(Y({email:v(C(),j(1,"Please enter your email."),Le("The email address is badly formatted")),username:v(C(),j(1,"Please enter your username."),j(3,"Username should be 3 or more symbols")),name:v(C(),j(1,"Please enter your name or nickname."),j(3,"Name or nickname should be 3 or more symbols")),password:v(C(),j(1,"Please enter your password."),j(8,"Your password must have 8 characters or more."),Lt(/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)[a-zA-Z\d]{8,}$/,"Your password must have one uppercase letter, one lowercase letter and one number")),passwordConfirm:v(C(),j(1,"Please confirm password"))}),Mt(Ot(t=>t.password===t.passwordConfirm,"The two passwords do not match"),["passwordConfirm"])),ct=({addUser:t})=>{var c,p,m,g,h,x,b,y,f,U;const{register:s,handleSubmit:n,reset:r,formState:{errors:o,isSubmitting:i,isSubmitSuccessful:l}}=H({resolver:Z(oo)});u.useEffect(()=>{l&&r({username:"",email:"",password:"",passwordConfirm:"",name:""})},[l,r]);const{handleSignUp:d}=Js(t);return e.jsxs("div",{style:{backgroundColor:"#397453"},children:[e.jsx(E,{sx:_s,children:e.jsx(E,{sx:eo,children:e.jsxs(E,{component:"main",sx:so,children:[e.jsx(k,{gap:4,sx:{mb:2},children:e.jsxs(k,{gap:1,children:[e.jsx(ne,{component:"h1",level:"h3",sx:{color:"#f7e382"},children:"Sign up"}),e.jsxs(ne,{level:"body-sm",sx:z,children:["Already have an account?"," ",e.jsx(D,{to:"/login",sx:{color:"#E6E9E0"},children:"Sign in"})]})]})}),e.jsx(Qe,{sx:{bgcolor:"#bdac4e"}}),e.jsx(k,{gap:4,sx:{mt:2},children:e.jsxs("form",{onSubmit:n(d),children:[e.jsxs(O,{children:[e.jsx(q,{sx:z,children:"Username"}),e.jsx(F,{...s("username"),placeholder:"username","data-testid":"username",sx:J}),(c=o==null?void 0:o.username)!=null&&c.message?e.jsx("p",{style:{color:"red"},children:(p=o.username)==null?void 0:p.message}):null]}),e.jsxs(O,{children:[e.jsx(q,{sx:z,children:"Name"}),e.jsx(F,{...s("name"),placeholder:"name","data-testid":"name",sx:J}),(m=o==null?void 0:o.name)!=null&&m.message?e.jsx("p",{style:{color:"red"},children:(g=o.name)==null?void 0:g.message}):null]}),e.jsxs(O,{children:[e.jsx(q,{sx:z,children:"Email"}),e.jsx(F,{...s("email"),placeholder:"email","data-testid":"email",sx:J}),(h=o==null?void 0:o.email)!=null&&h.message?e.jsx("p",{style:{color:"red"},children:(x=o.email)==null?void 0:x.message}):null]}),e.jsxs(O,{children:[e.jsx(q,{sx:z,children:"Password"}),e.jsx(F,{type:"password",...s("password"),placeholder:"password...","data-testid":"password",autoComplete:"on",sx:J}),(b=o==null?void 0:o.password)!=null&&b.message?e.jsx("p",{style:{color:"red"},children:(y=o.password)==null?void 0:y.message}):null]}),e.jsxs(O,{children:[e.jsx(q,{sx:z,children:"Confirm Password"}),e.jsx(F,{type:"password",...s("passwordConfirm"),placeholder:"confirm password","data-testid":"password-confirm",autoComplete:"on",sx:J}),(f=o==null?void 0:o.passwordConfirm)!=null&&f.message?e.jsx("p",{style:{color:"red"},children:(U=o.passwordConfirm)==null?void 0:U.message}):null]}),e.jsx(Ge,{type:"submit",fullWidth:!0,disabled:i,id:"signup-button",sx:{fontSize:18},children:i?"Signing up...":"Sign Up"})]})})]})})}),e.jsx(E,{sx:to})]})};ct.propTypes={addUser:a.func.isRequired};const ee=u.forwardRef((t,s)=>{const[n,r]=u.useState(!1),o={display:n?"none":""},i={display:n?"":"none"},l=()=>{r(!n)};return u.useImperativeHandle(s,()=>({toggleVisibility:l})),e.jsxs("div",{children:[e.jsx("div",{style:o,children:e.jsx(I,{variant:"contained",size:"small",sx:{backgroundColor:"#79C094","&:hover":{backgroundColor:"#00532f"}},onClick:l,children:t.buttonLabel})}),e.jsxs("div",{style:i,className:"togglableContent",children:[t.children,e.jsx(I,{variant:"contained",size:"small",sx:{backgroundColor:"#9b000a","&:hover":{backgroundColor:"#730000"}},onClick:l,children:"cancel"})]})]})});ee.displayName="TogglableElement";ee.propTypes={buttonLabel:a.string.isRequired,children:a.node.isRequired};const ro={bgcolor:"#79C094",label:{color:"white"},input:{color:"white",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},"& label.Mui-focused":{color:"white"},"& label.Mui-error":{fontWeight:"bold"},"& .MuiInput-underline:after":{borderBottomColor:"yellow"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#397453"},"&:hover fieldset":{borderColor:"white"},"&.Mui-focused fieldset":{borderColor:"#bdac4e"},"&.Mui-error fieldset":{borderWidth:2}}},no=Y({content:v(C("Comment must be a string"),j(1,"Comments can not be empty"))}),le=({commentAction:t,commentId:s,authorId:n,label:r})=>{const{handleSubmit:o,reset:i,control:l,formState:{isSubmitting:d,isSubmitSuccessful:c}}=H({resolver:Z(no)});u.useEffect(()=>{c&&i({content:""})},[c,i]);const p=async({content:m})=>{t(m,s,n)};return e.jsx("form",{onSubmit:o(p),children:e.jsxs(k,{spacing:1,sx:{paddingBottom:1,display:"inline-flex"},children:[e.jsx($,{name:"content",label:r,fullWidth:!0,control:l,margin:"dense",InputProps:{sx:{borderRadius:0}},sx:ro}),e.jsx(ie,{isSubmitting:d,label:"Submit comment",submittingText:"Commenting...",normalText:"Submit comment",id:"comment-button"})]})})};le.propTypes={commentAction:a.func,commentId:a.string,authorId:a.string,label:a.string};const ao=Y({bio:v(C("About you should be a string"),j(1,"Please enter something about yourself.")),name:v(C("Name should be a string"),j(1,"Please enter your name"),j(3,"Name should be 3 or more symbols long")),avatar:v(Ft(File),qt(["image/jpeg","image/png","image/jpg","image/svg"]),Wt(1024*1024*2))}),ge={bgcolor:"#79C094",label:{color:"white",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},input:{color:"white",textShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},"& label.Mui-focused":{color:"white"},"& label.Mui-error":{fontWeight:"bold"},"& .MuiInput-underline:after":{borderBottomColor:"yellow"},"& .MuiOutlinedInput-root":{"& fieldset":{borderColor:"#397453"},"&:hover fieldset":{borderColor:"white"},"&.Mui-focused fieldset":{borderColor:"#bdac4e"},"&.Mui-error fieldset":{borderWidth:2}}},dt=({updateUser:t})=>{const{handleSubmit:s,control:n,formState:{isSubmitting:r,isSubmitSuccessful:o},reset:i}=H({resolver:Z(ao)});u.useEffect(()=>{o&&i({bio:"",name:"",avatar:null})},[o,i]);const l=d=>{const c=new FormData;c.append("avatar",d.avatar),c.append("bio",d.bio),c.append("name",d.name),t(c)};return e.jsx("form",{onSubmit:s(l),children:e.jsxs(k,{spacing:1,sx:{paddingBottom:1,paddingRight:1,maxWidth:"310px"},children:[e.jsx($,{name:"bio",label:"About you",fullWidth:!0,control:n,margin:"dense",InputProps:{sx:{borderRadius:0}},sx:ge}),e.jsx($,{name:"name",label:"Name",fullWidth:!0,control:n,margin:"dense",InputProps:{sx:{borderRadius:0}},sx:ge}),e.jsx(M,{children:"Upload Avatar"}),e.jsx(xe,{name:"avatar",control:n,render:({field:d})=>e.jsx(us,{...d,inputProps:{accept:".png, .jpeg, .jpg, .svg"},InputProps:{sx:{borderRadius:0}},placeholder:"Insert a file",sx:ge})}),e.jsx(I,{disabled:r,type:"submit",id:"update-button",variant:"contained",size:"small",sx:{backgroundColor:"#609b76","&:hover":{backgroundColor:"#00532f"},marginBottom:1},children:r?"Updating...":"Update your profile"})]})})};dt.propTypes={updateUser:a.func.isRequired};const re=({movies:t,header:s})=>{const n=t;return e.jsxs("div",{className:"movieList",style:{display:n.length===0?"none":""},children:[e.jsx("h3",{children:s}),e.jsx("div",{className:"profileMovieContainer",children:n==null?void 0:n.map(r=>e.jsx("div",{className:"movieSmallCard",children:e.jsx(Se,{movie:r})},`${r.id?r.id:r.tmdbId} header`))})]})};re.propTypes={movies:a.arrayOf(a.object).isRequired,header:a.string};const V="/api/users";let se=null;const io=t=>{se=`Bearer ${t}`},lo=async()=>(await A.get(V)).data,co=async t=>(await A.get(`${V}/${t}`)).data,uo=async t=>(await A.get(`${V}/${t}/avatar`)).data,po=async(t,s,n)=>{const r={headers:{Authorization:se}};return(await A.post(`${V}/${n}/movies`,{movie:t,button:s},r)).data},mo=async(t,s,n)=>{const r={headers:{Authorization:se},data:{button:s}};return(await A.delete(`${V}/${n}/movies/${t.id}`,r)).data},ho=async(t,s)=>{const n={headers:{Authorization:se,"Content-Type":"multipart/form-data"}};return(await A.put(`${V}/${t}`,s,n)).data},go=async t=>{const s={headers:{Authorization:se}};return(await A.delete(`${V}/${t}`,s)).data},R={setToken:io,getUsers:lo,getUser:co,addMovieToProfile:po,updateUser:ho,deleteUser:go,removeMovieFromProfile:mo,getUserAvatar:uo},ut=({comment:t,editForm:s,onDelete:n})=>{var l,d,c,p,m,g,h,x;const[r,o]=u.useState(""),i=X();return u.useEffect(()=>{(async()=>{var f;const y=await R.getUserAvatar((f=t.author)==null?void 0:f.id);o(y)})()},[(l=t.author)==null?void 0:l.id]),e.jsxs("div",{className:"singleComment",children:[e.jsxs(P,{alignItems:"flex-start",component:D,to:t.author?`/users/${(d=t.author)==null?void 0:d.id}`:"/users",children:[e.jsx(ze,{children:e.jsx(Ke,{alt:(c=t.author)==null?void 0:c.name,src:r})}),e.jsx(L,{primary:((p=t.author)==null?void 0:p.name)??"Deleted user",secondary:t.content,sx:{color:"#F7E382"},secondaryTypographyProps:{color:"white"}}),e.jsx(M,{children:t.createdAt?new Date(t.createdAt).toLocaleString():""})]}),e.jsx("div",{className:"commentButtons",children:i&&e.jsxs(e.Fragment,{children:[i.username===((m=t.author)==null?void 0:m.username)&&e.jsxs(e.Fragment,{children:[s(t.id,(g=t.author)==null?void 0:g.id),e.jsx(I,{variant:"contained",size:"small",onClick:()=>{var b;return n(t.id,(b=t.author)==null?void 0:b.id)},sx:{backgroundColor:"#9b000a","&:hover":{backgroundColor:"#730000"},marginLeft:2,alignSelf:"start"},children:"Delete comment"})]}),i.username===((h=t.receiver)==null?void 0:h.username)&&i.username!==((x=t.author)==null?void 0:x.username)&&e.jsx(I,{variant:"contained",size:"small",onClick:()=>{var b;return n(t.id,(b=t.author)==null?void 0:b.id)},sx:{backgroundColor:"#9b000a","&:hover":{backgroundColor:"#730000"}},children:"Delete comment"})]})})]})};ut.propTypes={comment:a.object,editForm:a.func,onDelete:a.func};const pt=({onSort:t,sortDesc:s})=>e.jsxs("div",{className:"sort-comments",children:[e.jsx(I,{sx:{color:"#bdac4e"},children:e.jsx(ss,{onClick:t})}),e.jsxs(M,{sx:{paddingTop:"0.5em"},children:["Sorting by: ",s?"Newest first":"Oldest first"]})]});pt.propTypes={onSort:a.func.isRequired,sortDesc:a.bool.isRequired};const xo=(t,s)=>t==null?void 0:t.slice().sort((r,o)=>{const i=new Date(r.createdAt),l=new Date(o.createdAt);return s?l-i:i-l}),Ie=({comments:t,onEdit:s,onDelete:n})=>{const r=u.useRef(),[o,i]=u.useState(!0);if(!t||t.length===0)return e.jsx(M,{variant:"h6",sx:{paddingTop:2},children:"No comments yet..."});const l=(p,m,g)=>{r.current.toggleVisibility(),s(m,p,g)},d=(p,m)=>e.jsx(ee,{buttonLabel:"edit comment",ref:r,children:e.jsx(le,{commentAction:l,commentId:p,authorId:m,label:"Edit your comment"})}),c=xo(t,o);return e.jsxs(e.Fragment,{children:[e.jsx(pt,{sortDesc:o,onSort:()=>i(!o)}),e.jsx(je,{sx:{width:"100%",maxWidth:600,backgroundColor:"#397453"},children:c.map(p=>e.jsx("div",{children:e.jsx(ut,{comment:p,editForm:d,onDelete:n})},p.id))})]})};Ie.propTypes={comments:a.arrayOf(a.object),onEdit:a.func,onDelete:a.func};const mt=({currentUser:t,commentCreateForm:s,comments:n,deleteComment:r,updateComment:o})=>e.jsxs("div",{className:"userProfileComments",children:[e.jsx("h2",{children:"Comments"}),e.jsx("div",{className:"profileCommentTogglable",children:t&&s()}),e.jsx(Ie,{comments:n,onDelete:r,onEdit:o})]});mt.propTypes={currentUser:a.object,commentCreateForm:a.func.isRequired,comments:a.arrayOf(a.object),deleteComment:a.func.isRequired,updateComment:a.func.isRequired};const ht=({name:t,biography:s})=>e.jsxs(e.Fragment,{children:[e.jsx("h1",{children:e.jsx("strong",{children:t===""||!t?"Anonymous user":t})}),e.jsxs("div",{children:[e.jsx("h2",{children:"About me"}),e.jsx("p",{children:s===""||!s?"We don't know anything about them yet":s})]})]});ht.propTypes={name:a.string,biography:a.string};const gt=({user:t,updateForm:s,deleteUser:n})=>{const r=X();return e.jsx("div",{className:"profileButtons",children:r&&(r==null?void 0:r.username)===t.username&&e.jsxs(e.Fragment,{children:[s(),e.jsx(I,{sx:{backgroundColor:"#9b000a","&:hover":{backgroundColor:"#730000"},alignSelf:"start"},variant:"contained",size:"small",onClick:n,children:"Delete user"})]})})};gt.propTypes={user:a.oneOfType([a.object,a.string]),updateForm:a.func.isRequired,deleteUser:a.func.isRequired};const Me="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASwAAAEsCAYAAAB5fY51AAAACXBIWXMAAC4jAAAuIwF4pT92AAAPCUlEQVR4nO3daXPaVhuA4QcQiMXsizG4deJpkv//c5LYbt2ExcYYhG2M2PR+eCeeSZM2tlmOnqP7msmHtpP46SHcCCGOYufn54EAgAJx0wMAwHMRLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqECwAahAsAGoQLABqOKYHgB6+78t0OpXHx0fxfV9835f1ei2r1erpVyKRePoVj8fFdV1xXVcymYxks1lxXdf0/wYUI1j4V6vVSjzPE8/z5O7uThaLxbN+z2q1evrnh4eH7/57MpmUfD4vxWJRisWiJBKJrc8Ne8XOz88D00MgPIIgEM/zZDgciud5EgS7++sRi8WkWCxKtVqVYrEosVhsZz8LduAICyIisl6vZTAYyPX1tczn8738zCAIZDwey3g8llQqJY1GQ+r1usTjnFrFz3GEFXFBEMj19bX0+31ZLpemxxHHcaTZbEqj0eCICz8gWBHmeZ58+fJFfN83PcoPXNeV4+NjKZVKpkdBiBCsCFoul/L333/LaDQyPcovlctl+e233ySZTJoeBSHAOayI8TxPLi8vn/WJXxiMRiO5v7+Xk5MTKRaLpseBYZzdjJB+vy9nZ2dqYvXNYrGQs7Mz6fV6pkeBYRxhRcB6vZbLy0u5vb01PcpGut2uzGYzOTk54ZPEiCJYllsul3J2dvbDBZxa3d7eiu/78scff4jj8Nc3aniZsthisZCPHz9aE6tvHh4e5OPHj+re2mJzBMtSy+VSPn36JLPZzPQoOzGbzeTTp0+huHYM+0OwLLRareTz58/Wxuqb2Wwmnz9//u67i7AbwbJMEARycXEh0+nU9Ch7MZ1O5eLiYqffeUR4ECzLdDodmUwmpsfYq8lkIp1Ox/QY2AOCZZHRaCRXV1emxzDi6upKxZX72AzBssR8PpfLy0vTYxh1eXkZyu9FYnsIliX+/PPPyJ98Xq1W8tdff5keAztEsCwwGAzk/v7e9BihcH9/L4PBwPQY2BGCpdxiseCE8z90Oh0uKrUUwVKu2+1G/q3gP61WKyJuKYKl2OPjo9zc3JgeI5SGw6E8Pj6aHgNbRrAU63a7pkcINdbHPgRLqel0KuPx2PQYoTYejyNzxX9UECylonqB6EuxTnYhWAotFguu6n6m0WjEJ4YWIVgK3dzc8GXfZwqCgA8mLEKwFBoOh6ZHUIX1sgfBUmY6nfJ9uRfyfZ+T75YgWMpw7up1WDc7ECxleOK9DutmB4KlyOPjI28HX8n3fa58twDBUuTu7s70CKqxfvoRLEV4wm2G9dOPYCli2/0F9431049gKbFYLLhie0OsoX4ESwlOGG8H66gbwVKCJ9p2sI66ESwl5vO56RGswDrqRrCU4Im2HayjbgRLCZ5o28E66kawlOBGE9vBOupGsJRYLpemR7AC66gbwVKCDfu2g3XUjWApsV6vTY9gBdZRN4KlRCwWMz0CYBzBUiIe56HaBtZRNx49JRKJhOkRrMCRqm4ESwmODLbDcRzTI2ADPAuUIFjbwZGqbjwLlEilUqZHsALrqBvBUoIn2nYkk0nTI2ADBEsJgrUdruuaHgEbIFhKZDIZ0yNYgXXUjWApwRNtO1hH3QiWEslkkvMvG2IN9SNYiuRyOdMjqMb66UewFMnn86ZHUI31049gKcITbjOsn34ES5FMJsPH8q/kui4n3C1AsJQpl8umR1CJdbMDwVKGJ97rsG52IFjKZLNZ3ha+kOu6ks1mTY+BLSBYClWrVdMjqMJ62YNgKVSr1diI7plisZjUajXTY2BLCJZCyWSSczLPVC6XubrdIgRLqcPDQ9MjqMA62YVgKZXNZqVUKpkeI9RKpRIn2y1DsBRrtVqmRwg11sc+BEuxTCbDCeV/Ua1WubLdQgRLuVarxY0V/iGRSEi73TY9BnaAYCmXTCZ5cv5Du93mk0FLESwL1Ot1OTg4MD1GKBwcHEi9Xjc9BnaEYFni7du3kX9rmEgk5M2bN6bHwA4RLEukUik5OTkxPYZRJycnfM/ScgTLIuVyObIXSh4eHnL1fwQQLMu0220pFAqmx9irQqHABw8RQbAsE4vF5PT0NDJXeGezWTk9PeXL4BFBsCyUSCTk3bt3kk6nTY+yU+l0Wt69exf5DxuihGBZynEcef/+vbXRSqfT8v79e3Ecx/Qo2COCZbFkMikfPnyw7n58uVxOPnz4wMWhEUSwLPftSKtSqZgeZSsqlQpHVhHGox4B8Xhc3r59K5lMRjqdjulxXq3VasnR0ZHpMWAQwYqQZrMpmUxGLi8vZbFYmB7n2RzHkTdv3kixWDQ9CgyLnZ+fB6aHwH4tFgv58uWLjEYj06P8UqlUkt9//53zVRARghVp4/FYvn79Kr7vmx7lB67ryvHxMbuq4ju8JYywUqkkxWJRrq+vpd/vy3K5ND2SOI4jzWZTGo0GF4PiBxxhQURE1uu1DAYDub6+lvl8vvefn0qlpNFoSL1el3icD6/xcwQL3wmCQDzPk+FwKJ7nSRDs7q9HLBaTYrEo1WpVisUiR1T4Jd4S4juxWExKpZKUSiVZrVbieZ54nid3d3db+WQxmUxKPp+XYrEoxWKRr9XgRTjCwrP5vi/T6VSm06nM53PxfV8Wi4WsVitZr9cSBIHEYjGJx+OSSCQkmUxKKpUS13Ulm81KNptlvypshCMsPJvruuK6LvtOwRjObgJQg2ABUINgAVCDYAFQg2ABUINgAVCDYAFQg2ABUIMLR7EV0+n0aTfTdrsdmduMYb8IFjbi+750u125vb19+neTyUTK5bK0222+ioOtIlh4lcViIb1eT25ubn66o8NoNJLxeCy1Wk2Ojo7YMRRbwZef8SKr1Uqurq7k6upK1uv1s35PPB6Xw8NDOTw8ZHcGbIRg4VmCINh4Z1J2E8WmCBZ+aTgcSrfb3dpOpKlUSlqtllSr1a38eYgOgoV/5XmedDodeXx83Mmfn8lkpN1uc/suPBvBwg8eHh7k69evcn9/v5efd3BwIMfHx5LL5fby86AXwcKT2WwmnU5HxuOxkZ9fKpWk3W5LOp028vMRflzWAJnP59Lr9WQ4HO70phO/Mh6PxfM8qVarcnR0JKlUytgsCCeOsCJsuVxKv9+XwWDw7EsU9iUej0u9XpdmsymOw+sq/o9gRdB6vX66RGG1Wpke5z8lEomnSyG4XyEIVoQEQfB0icI2btm1T8lk8ulSCK7hii6CFRGj0Ui63a7MZjPTo2wknU5Lq9Xizj0RRbAsd3d3J51ORx4eHkyPslW5XE7a7bbk83nTo2CPCJalvm33MplMTI+yU4VCge1sIoSPXyzzs+1ebDaZTGQymUilUpFWq8V2NpYjWJZYLpfS6/VkMBgYvZbKlNvbWxmNRk+XQrCdjZ14S6jcer2Wfr//ou1ebPdtO5tms8mlEJYhWEoFQSCDwUB6vd6rt3uxneM4cnR0JPV6nUshLEGwFLq9vZVutyu+75seRYVUKiXtdlsqlYrpUbAhgqXIrrd7sR3b2ehHsBR4eHiQTqcjd3d3pkexQj6fl3a7zXY2ChGsEDO93Yvt2M5GHy5rCKHFYiHdbtf4di+2YzsbfTjCCpHVaiX9fl+ur6+5RGHP4vG4NBoNaTab3NknxAhWCGja7sV2bGcTbgTLoG/bvfR6va3dkQbbwXY24USwDBmPx9LpdNRv92K7dDot7XZbSqWS6VEgBGvvbN3uxXZsZxMOBGuPLi4uZDQamR4DGyiXy3J6emp6jMjirOIesYOAfjyGZhGsPWo0GqZHwIZ4DM0iWHvkui4nbxUrlUpsEGgYwdozXqH1qtfrpkeIPIK1Z/l8nv3HFUqn01IoFEyPEXkEywBeqfU5PDw0PQKEYBlRqVS4/boijuOw+V9IECwD4vE4R1mK1Ot1vlcYEjwKhrDPuA6xWIwXlxAhWIYkk0neZihQqVS4WDRECJZBXOIQfjxG4UKwDMpms3yZNsS4BCV8CJZhvIKHF49N+BAsw/i6RzjxNapwIlghwCt5+PCYhBPBCoFarcaND0IkkUhIrVYzPQZ+gmCFQDwe5wkSIrVajQtFQ4pHJSQajQYXkoZALBbj7WCIEayQSKVSnOQNgVKpxA1VQ4xghQg7ApjHYxBuBCtEcrmc5HI502NEFusffgQrZHiFN4e1Dz+CFTKcQzGDc4g6EKyQ4VMqM/iUVgeCFUJcB7RfXAenB8+KEOJK6/3imwZ6EKyQ4m3h/rDWehCskGK3gP1gtwxdCFaI8cq/e6yxLgQrxNjxcrfY8VUfghVyHAHsDmurD8EKOe7ashvctUgnghVy3BdvN7gvpE4ESwHuPLxd3HlbL54FCjiOw9uXLapUKuI4jukx8AoESwl2Etge1lIvgqVEOp2WQqFgegz1CoWCpNNp02PglQiWIhwZbI411I1gKcLRwWY4StWPYCnDEcLr8cmgfgRLGT7heh227LEDwVImHo9LtVo1PYY6bIpoBx5BhdjO92XYdtoeBEshbpjwMtzYwx4ESylOvj8fa2UPgqUUN/18HtbJLgRLMY4cfo01sgvBUoxzM/+Nc332IViK8enXf+PTVPvEzs/PA9NDAMBzcIQFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQA2CBUANggVADYIFQI3/AcrpZrtDmlwYAAAAAElFTkSuQmCC",xt=({avatar:t,setAvatar:s,user:n,updateForm:r,deleteUser:o})=>e.jsxs("div",{className:"userAvatar",children:[e.jsx("img",{src:t||Me,onError:()=>s(Me),width:"300",height:"300",alt:"user avatar",className:"avatar"}),e.jsx(gt,{user:n,updateForm:r,deleteUser:o})]});xt.propTypes={avatar:a.string,setAvatar:a.func.isRequired,user:a.oneOfType([a.object,a.string]),updateForm:a.func.isRequired,deleteUser:a.func.isRequired};const bo=(t,s,n)=>{const[r,o]=u.useState(""),[i,l]=u.useState(""),[d,c]=u.useState([]),[p,m]=u.useState([]),[g,h]=u.useState([]),x=u.useRef(),b=u.useRef(),y=ae(),f=te();return u.useEffect(()=>{(async()=>{const{user:w,avatarUrl:B}=await R.getUser(n);l(B),o(w),c(w.favoriteMovies),m(w.watchedMovies),h(w.watchLaterMovies)})()},[n]),{user:r,avatar:i,setAvatar:l,favoriteMovies:d,watchedMovies:p,watchLaterMovies:g,updateFormRef:x,commentFormRef:b,updateUser:async S=>{try{x.current.toggleVisibility();const{user:w,avatarUrl:B}=await R.updateUser(n,S);f({type:"SHOW",payload:{message:`User ${w.name?w.name:""} successfully updated`,type:"success"}}),setTimeout(()=>f({type:"HIDE"}),5e3),o(w),l(B)}catch{f({type:"SHOW",payload:{message:"Something went wrong when updating user",type:"error"}}),setTimeout(()=>f({type:"HIDE"}),5e3)}},deleteUser:async()=>{if(window.confirm("Are you sure you want to delete your profile? This can't be undone"))try{await R.deleteUser(r.id),s(r.id),window.localStorage.removeItem("loggedKinologyUser"),window.location.reload(),y("/users"),f({type:"SHOW",payload:{message:`User ${r.name} successfully deleted`,type:"success"}}),setTimeout(()=>f({type:"HIDE"}),5e3)}catch{f({type:"SHOW",payload:{message:"Something went wrong when deleting a comment",type:"error"}}),setTimeout(()=>f({type:"HIDE"}),5e3)}}}},ce="/api/comments",Ue=t=>({headers:{Authorization:`Bearer ${t}`}}),fo=async(t,s)=>{const n=`${ce}/${s}/${t}`;return(await A.get(n)).data},yo=async(t,s,n,r,o,i)=>{const l=`${ce}/${i}/${t}/${s}`,d=Ue(n.token);return(await A.put(l,{content:r,authorId:o},d)).data},jo=async(t,s,n,r,o)=>{const i={...Ue(n.token),data:{authorId:r}},l=`${ce}/${o}/${t}/${s}`;return(await A.delete(l,i)).data},vo=async(t,s,n,r,o,i)=>{const l=Ue(n.token),d=`${ce}/${r}/${t}`,c={content:s,...r==="movie"&&{movieTitle:o,moviePoster:i}};return(await A.post(d,c,l)).data},oe={getComments:fo,createComment:vo,deleteComment:jo,updateComment:yo},bt=(t,s,n,r)=>{const[o,i]=u.useState([]),l=te();return u.useEffect(()=>{(async()=>{const g=await oe.getComments(t,s);i(g)})()},[t,s]),{comments:o,createComment:async m=>{try{const g=await oe.createComment(t,m,n,s,s==="movie"?r.title:"",s==="movie"?r.image:"");i(o.concat(g)),l({type:"SHOW",payload:{message:`Comment '${m}' successfully added`,type:"success"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}catch{l({type:"SHOW",payload:{message:"Something went wrong when commenting on a movie",type:"error"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}},deleteComment:async(m,g)=>{if(window.confirm("Are you sure you want to delete the comment?"))try{const h=o.filter(x=>x.id!==m);i(h),await oe.deleteComment(t,m,n,g,s),l({type:"SHOW",payload:{message:"Comment successfully deleted",type:"success"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}catch{l({type:"SHOW",payload:{message:`Something went wrong when deleting a comment on ${r.title}`,type:"error"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}},updateComment:async(m,g,h)=>{try{const x=await oe.updateComment(t,m,n,g,h,s);i(o.map(b=>b.id===x.id?x:b)),l({type:"SHOW",payload:{message:`Comment successfully updated with '${g}'`,type:"success"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}catch{l({type:"SHOW",payload:{message:"Something went wrong when updating a comment",type:"error"}}),setTimeout(()=>l({type:"HIDE"}),5e3)}}}},ft=({removeUser:t})=>{const{id:s}=$e(),n=X(),{user:r,avatar:o,favoriteMovies:i,watchedMovies:l,watchLaterMovies:d,updateFormRef:c,commentFormRef:p,updateUser:m,deleteUser:g,setAvatar:h}=bo(n,t,s),{comments:x,createComment:b,deleteComment:y,updateComment:f}=bt(s,"profile",n),U=()=>e.jsx(ee,{buttonLabel:"update profile",ref:c,children:e.jsx(dt,{updateUser:m})}),Q=()=>e.jsx(ee,{buttonLabel:"leave a comment",ref:p,children:e.jsx(le,{commentAction:b,label:"Your comment"})});return e.jsx("div",{className:"outerContainer",children:e.jsxs("div",{className:"userPage",children:[e.jsxs("div",{className:"userProfileContainer",children:[e.jsx(xt,{avatar:o,setAvatar:h,user:r,updateForm:U,deleteUser:g}),e.jsxs("div",{className:"userInformation",children:[e.jsx(ht,{name:r.name,biography:r.biography}),e.jsx(re,{movies:d,header:"Watch List"}),e.jsx(re,{movies:i,header:"Favorite movies"}),e.jsx(re,{movies:l,header:"Already seen"})]})]}),e.jsx(mt,{currentUser:n,commentCreateForm:Q,comments:x,deleteComment:y,updateComment:f})]})})};ft.propTypes={removeUser:a.func.isRequired};const wo={backgroundColor:"#79C094",color:"#fff",borderRadius:10,marginBottom:1,border:"3px solid #bdac4e",boxShadow:"1px 1px 2px rgba(13, 4, 2, 1)"},Co={style:{color:"#bdac4e",textShadow:"0.5px 0.5px 2px rgba(13, 4, 2, 0.8)",fontSize:18,fontWeight:"bold"}},Ao={style:{color:"white",textShadow:"0.5px 0.5px 2px rgba(13, 4, 2, 1)"}},yt=({user:t})=>{const[s,n]=u.useState("");return u.useEffect(()=>{(async()=>{const o=await R.getUserAvatar(t.id);n(o)})()},[t.id]),e.jsxs(P,{alignItems:"flex-start",sx:wo,component:D,to:`/users/${t.id}`,children:[e.jsx(ze,{children:e.jsx(Ke,{alt:t==null?void 0:t.name,src:s})}),e.jsx(L,{primary:t.name,secondary:t.biography!==""?t.biography:"We don't know much about them yet...",primaryTypographyProps:Co,secondaryTypographyProps:Ao})]})};yt.propTypes={user:a.object.isRequired};const jt=({users:t})=>t?e.jsx("div",{children:e.jsx(je,{sx:{width:"100%",backgroundColor:"#2F764F",padding:5},className:"userList",children:t==null?void 0:t.map(s=>e.jsx("div",{children:e.jsx(yt,{user:s})},s.id))})}):e.jsx(e.Fragment,{children:"no users yet"});jt.propTypes={users:a.arrayOf(a.object).isRequired};const vt=({currentUser:t,createComment:s,comments:n,deleteComment:r,updateComment:o})=>e.jsxs("div",{className:"singleMovieComments",children:[e.jsx("h2",{children:"Comments"}),t?e.jsx(le,{commentAction:s,label:"Your comment"}):"",e.jsx(Ie,{comments:n,onDelete:r,onEdit:o})]});vt.propTypes={currentUser:a.object,comments:a.arrayOf(a.object),deleteComment:a.func.isRequired,updateComment:a.func.isRequired,createComment:a.func.isRequired};const So=t=>{const[s,n]=u.useState("");return u.useEffect(()=>{(async()=>{const o=await Ae.getSingleMovie(t);n(o)})()},[t]),{movie:s}},Io="https://image.tmdb.org/t/p/original",wt=({movie:t})=>e.jsx("div",{className:"singleMovieImage",children:e.jsx("img",{src:t.image?`${Io}${t==null?void 0:t.image}`:_,alt:t.image?`${t.title} poster`:"Icon made by Freepik from www.flaticon.com",width:"400",className:"movieImageElement"})});wt.propTypes={movie:a.oneOfType([a.object,a.string])};const Ct=({genres:t})=>{if(t)return e.jsx(os,{orientation:"horizontal",variant:"outlined",sx:{justifyContent:"center",padding:0,borderWidth:0},children:t.map(s=>e.jsx("div",{children:e.jsx(rs,{sx:{color:"#bdac4e",fontSize:"1.3rem"},children:s.name})},s.id))})};Ct.propTypes={genres:a.oneOfType([a.arrayOf(a.string),a.arrayOf(a.object)])};const At=({movie:t,user:s,buttonPress:n,buttonUnpress:r,movieId:o})=>e.jsxs("div",{className:"singleMovieDescription",children:[e.jsx("h1",{children:t.title}),e.jsx("p",{children:e.jsx("i",{children:t.slogan})}),e.jsx("p",{style:{maxWidth:"800px"},children:t.overview}),e.jsx(Ct,{genres:t==null?void 0:t.genres}),e.jsxs("p",{children:[t.rating," rating"]}),e.jsxs("p",{children:["released ",t.release]}),e.jsxs("p",{children:[t.runtime," minutes"]}),s?e.jsxs(e.Fragment,{children:[e.jsx(W,{unpressedText:"Watch",pressedText:"Unwatch",onButtonPress:i=>n(i,"later"),onButtonUnpress:i=>r(i,"later"),movieId:o,user:s}),e.jsx(W,{unpressedText:"Favorite",pressedText:"Unfavorite",onButtonPress:i=>n(i,"favorite"),onButtonUnpress:i=>r(i,"favorite"),movieId:o,user:s}),e.jsx(W,{unpressedText:"Seen",pressedText:"Unsee",onButtonPress:i=>n(i,"watched"),onButtonUnpress:i=>r(i,"watched"),movieId:o,user:s})]}):""]});At.propTypes={movie:a.oneOfType([a.object,a.string]),buttonPress:a.func.isRequired,buttonUnpress:a.func.isRequired,movieId:a.string.isRequired,user:a.object};const St=({onButtonPress:t,onButtonUnpress:s,user:n})=>{const{id:r}=$e(),{movie:o}=So(r),{comments:i,createComment:l,deleteComment:d,updateComment:c}=bt(r,"movie",n,o),p=(g,h)=>{t(g,h,{id:r,title:o.title,poster:o.image})},m=(g,h)=>{s(g,h,{id:r})};return e.jsx("div",{className:"outerMovieContainer",children:e.jsxs("div",{className:"moviePage",children:[e.jsxs("div",{className:"singleMovieContainer",children:[e.jsx(wt,{movie:o}),e.jsx(At,{movie:o,user:n,buttonPress:p,buttonUnpress:m,movieId:r})]}),e.jsx(vt,{currentUser:n,createComment:l,comments:i,deleteComment:d,updateComment:c})]})})};St.propTypes={onButtonPress:a.func,onButtonUnpress:a.func,user:a.object};const Uo=()=>{const{message:t,type:s}=hs();return t?e.jsx("div",{className:"notification",children:e.jsx(ns,{severity:s,children:t})}):null},Bo="/api/login",To=async t=>(await A.post(Bo,t)).data,Ro={login:To},ko=t=>{try{return JSON.parse(atob(t.split(".")[1]))}catch{return null}},No=t=>{let s=cs();u.useEffect(()=>{const n=JSON.parse(localStorage.getItem("loggedKinologyUser"));n&&ko(n.token).exp*1e3<Date.now()&&t.logOut()},[s,t])},Po=()=>{const[t,s]=u.useState([]),n=X(),r=te(),o=Ze(),i=ae();u.useEffect(()=>{const h=window.localStorage.getItem("loggedKinologyUser");if(h&&h!=null){const x=JSON.parse(h);o({type:"LOGIN",payload:x}),R.setToken(x.token)}},[]);const l=u.useCallback(()=>{o({type:"LOGOUT"}),window.localStorage.removeItem("loggedKinologyUser"),r({type:"SHOW",payload:{message:"Your session has run out, please log in again",type:"success"}}),setTimeout(()=>r({type:"HIDE"}),5e3),i("/login")},[o]);u.useEffect(()=>{(async()=>{const x=await R.getUsers();s(x)})()},[]);const d=h=>{s(t.concat(h))},c=h=>{try{s(t.filter(x=>x.id!==h)),r({type:"SHOW",payload:{message:"User deleted",type:"success"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}catch{r({type:"SHOW",payload:{message:"Something went wrong when deleting user",type:"error"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}},p=async(h,x,b)=>{var y;h.preventDefault();try{const f=(y=t.find(U=>U.username===n.username))==null?void 0:y.id;await R.addMovieToProfile(b,x,f),r({type:"SHOW",payload:{message:`Successfully added ${b.title} to ${x}`,type:"success"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}catch{r({type:"SHOW",payload:{message:"Something went wrong when adding a movie to your profile",type:"error"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}},m=async(h,x,b)=>{var y;h.preventDefault();try{const f=(y=t.find(U=>U.username===n.username))==null?void 0:y.id;await R.removeMovieFromProfile(b,x,f),r({type:"SHOW",payload:{message:"Successfully removed movie from your profile",type:"success"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}catch{r({type:"SHOW",payload:{message:"Something went wrong when removing a movie from your profile",type:"error"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}},g=async h=>{const{username:x,password:b}=h;try{const y=await Ro.login({username:x,password:b});window.localStorage.setItem("loggedKinologyUser",JSON.stringify(y)),R.setToken(y.token),o({type:"LOGIN",payload:y}),r({type:"SHOW",payload:{message:"Successfully logged in",type:"success"}}),setTimeout(()=>r({type:"HIDE"}),5e3),i("/")}catch(y){r({type:"SHOW",payload:{message:`Something went wrong when logging in: ${y.response.data.error}`,type:"error"}}),setTimeout(()=>r({type:"HIDE"}),5e3)}};return e.jsxs(e.Fragment,{children:[e.jsx(it,{}),e.jsx(Uo,{}),e.jsxs(ds,{children:[e.jsx(N,{path:"/users/:id",element:e.jsx(ft,{removeUser:c})}),e.jsx(N,{path:"/",element:e.jsx(at,{onButtonPress:p,onButtonUnpress:m})}),e.jsx(N,{path:"/movies/:id",element:e.jsx(St,{onButtonPress:p,onButtonUnpress:m,user:n})}),e.jsx(N,{path:"/signup",element:e.jsx(ct,{addUser:d})}),e.jsx(N,{path:"/login",element:e.jsx(ye,{handleLogin:g})}),e.jsx(N,{path:"/about",element:e.jsx(Hs,{})}),e.jsx(N,{path:"/users",element:n?e.jsx(jt,{users:t,removeUser:c}):e.jsx(Re,{replace:!0,to:"/login"})}),e.jsx(N,{path:"/me",element:n!==null?e.jsx(Re,{replace:!0,to:`/users/${n.id}`}):e.jsx(ye,{handleLogin:g})})]}),e.jsx(No,{logOut:l})]})};Bt.createRoot(document.getElementById("root")).render(e.jsx(Rt,{children:e.jsx(xs,{children:e.jsx(ms,{children:e.jsx(Po,{})})})}));
